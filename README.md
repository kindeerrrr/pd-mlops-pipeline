# PD Default Prediction — MLOps Pipeline

## Описание проекта

Проект посвящён разработке и автоматизации пайплайна машинного обучения
для предсказания вероятности дефолта клиента по кредитной карте (PD-модель).

Решение реализовано в формате end-to-end MLOps пайплайна и включает:
- подготовку и валидацию данных,
- обучение модели с логированием экспериментов,
- контроль версий данных и моделей,
- REST API для инференса,
- автоматизацию воспроизведения пайплайна.

Домен: **финансы / кредитный скоринг**

---

## Датасет

**Default of Credit Card Clients Dataset**  
Источник: UCI Machine Learning Repository

Целевая переменная:
- `target` — дефолт клиента в следующем месяце (1 — дефолт, 0 — нет)

---

## Структура проекта

```text
pd-mlops-pipeline/
├── src/
│   ├── data/
│   │   └── prepare_data.py      # Подготовка и очистка данных
│   ├── models/
│   │   └── train.py             # Обучение модели + MLflow
│   └── api/
│       └── app.py               # FastAPI приложение
├── data/
│   ├── raw/                     # Исходные данные (DVC)
│   └── processed/               # Обработанные данные (DVC)
├── models/                      # Обученные модели
├── dvc.yaml                     # DVC pipeline
├── requirements.txt
├── README.md
```

## Используемые технологии
	•	Python 3.12
	•	pandas
	•	scikit-learn
	•	MLflow — логирование экспериментов
	•	DVC — контроль версий данных и моделей
	•	FastAPI — REST API
	•	Uvicorn — ASGI сервер

## DVC пайплайн

Пайплайн состоит из двух этапов:

1. prepare
	•	загрузка и очистка данных
	•	сохранение обработанного датасета

2. train
	•	обучение модели Logistic Regression
	•	расчёт метрик качества
	•	логирование эксперимента в MLflow
	•	сохранение обученной модели

Запуск пайплайна: dvc repro

## Качество модели

Метрики на тестовой выборке:
	•	ROC-AUC: ~0.71
	•	Precision: ~0.69
	•	Recall: ~0.24
	•	F1-score: ~0.36

Модель демонстрирует базовое, но приемлемое качество
для учебного скорингового решения.

## MLflow Tracking

Для просмотра экспериментов выполните команду: mlflow ui

Интерфейс MLflow будет доступен по адресу: http://127.0.0.1:5000

В MLflow логируются:
	•	параметры модели,
	•	метрики качества,
	•	артефакты (ROC-кривая, модель).


## REST API

Для запуска API выполните команду: uvicorn src.api.app:app --reload

Swagger UI доступен по адресу: http://127.0.0.1:8000/docs

Доступные эндпоинты
	•	POST /predict — возвращает класс и вероятность дефолта клиента

## Итоги:

В рамках проекта реализован воспроизводимый MLOps пайплайн,
включающий подготовку данных, обучение модели, контроль версий,
логирование экспериментов и REST API для инференса.

Проект демонстрирует базовые принципы промышленной разработки
и сопровождения моделей машинного обучения.